---
sort: 2
---

## 控制模式
### 位置模式
&emsp;&emsp;在位置模式下，电机的输出轴将会稳定在一个固定的位置。例如，如果我们希望电机输出端固定在3.14弧度的位置，可以将控制参数如下设置：
```
cmd.T = 0.0; 
cmd.W = 0.0;
cmd.Pos = 3.14*6.33;
cmd.K_P = 0.02;
cmd.K_W = 0.0;
```
&emsp;&emsp;在上述参数设置中，将T与W设置为0，即可成为针对Pos的PD控制。其中K_P为比例系数， K_W为微分系数，6.33为减速比。
&emsp;&emsp;在尝试完成上述修改后，重新编译并运行相关可执行文件，即可从电机返回的状态看出，电机转子的位置稳定在弧度，即电机输出端固定在3.14弧度的位置。可知，如果目标位置和当前位置之间差距很大，那么电机产生的力矩也会很大，从而产生一个很大的电流。如果给电机供电的电源的输出电流上限较小，可能会出现电源保护，即电机停止旋转。此时就需要考虑让cmd.Pos缓慢变化，避免产生瞬间的极大力矩。

### 速度模式
&emsp;&emsp;在速度模式下，电机的输出轴将会稳定在一个固定的速度。令电机输出轴转速稳定在5rad/s：
```
cmd.T = 0.0;
cmd.W = 6.28*6.33;
cmd.Pos = 0.0;
cmd K_P = 0.0;
cmd.K_W = 0.002;
```
速度模式T和K_P必须为0，这样就构成了对W的P控制。其中K_W为速度的比例系数。

### 阻尼模式
&emsp;&emsp;阻尼模式是一种特殊的速度模式。当我们令W = 0.0时，电机会保持转轴速度为0。并且在被外力旋转时，产生一个阻抗力矩。这个力矩的方向与旋转方向相反，大小与旋转速度成正比。当停止外力旋转后，电机会静止在当前位置。因为这种状态和线性阻尼器类似，所以被称为阻尼模式。
```
cmd.T = 0.0;
cmd.W = 0.0;
cmd.Pos = 0.0;
cmd K_P = 0.0;
cmd.K_W = 0.002;
```

### 力矩模式
&emsp;&emsp;在力矩模式下，电机会持续输出一个恒定力矩。但是当电机空转时，如果给一个较大的目标力矩，电机会持续加速，直到最大速度，这时也仍然达不到目标力矩。
下面提供一个无负载情况下比较安全的力矩模式参数设置：
```
cmd.T = 0.05;
cmd.W = 0.0;
cmd.Pos = 0.0;
cmd.K_P = 0.0;
cmd.K_W = 0.0;
```
&emsp;&emsp;在该参数下，可以观察到电机在恒定力矩下逐渐加速的过程。因为各个电机之间存在细微差异，如果电机无法顺利旋转，可以适量增大T的数值或用手轻轻助推一下。

### 零力矩模式
&emsp;&emsp;零力矩模式是一种特殊的力矩模式。当我们将命令修改为下列设置时，电机会保持转轴的力矩为0：
```
cmd.T = 0.0;
cmd.W = 0.0;
cmd.Pos = 0.0;
cmd.K_P = 0.0;
cmd.K_W = 0.0;
```
此时电机并不是停止运转，而是主动产生力矩来抵抗自身的摩擦力矩。在零力矩模式下，尝试转动输出轴，会感觉输出轴的阻力明显小于未开机时的阻力。

### 力位混合模式
&emsp;&emsp;在实际控制时，控制器往往会给关节同时发送前馈力矩、目标角度和目标角速度。这时的控制模式就是力位混合控制，这也是我们在后面的实际应用中使用最多的一种控制模式。
